(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[476],{7758:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var a=s(95155),r=s(12115),l=s(81013),n=s(17703),i=s(40283),c=s(20858),d=s(55628),o=s(14170),m=s(82771),x=s(6865),h=s(26884);let u=()=>{var e;let{user:t}=(0,i.A)(),{studentsWithCourses:s,authorizedPersons:u,pickupLogs:g}=(0,c.M)(),[p,v]=(0,r.useState)(null),[f,j]=(0,r.useState)([]),[N,w]=(0,r.useState)(!0);(0,r.useEffect)(()=>{(async()=>{if(w(!0),(null==t?void 0:t.email)&&s.length>0){let e=t.email,a=s.find(t=>t.rut_passport===e);a&&(v(a),j(g.filter(e=>e.student_id===a.id).map(e=>{let t=s.find(t=>t.id===e.student_id),r=u.find(t=>t.id===e.authorized_person_id);return{...e,student:t||a,authorized_person:r||{id:"unknown",full_name:"Persona no identificada",relationship:"Desconocido",student_id:e.student_id}}}).sort((e,t)=>new Date(t.pickup_timestamp).getTime()-new Date(e.pickup_timestamp).getTime())))}w(!1)})()},[t,s,u,g]);let b=e=>new Intl.DateTimeFormat("es-CL",{weekday:"long",year:"numeric",month:"long",day:"numeric"}).format(new Date(e));return p?(0,a.jsx)(l.A,{children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Historial de Retiros"}),(0,a.jsxs)("p",{className:"text-gray-600",children:["Registro completo de retiros de ",p.full_name]})]}),(0,a.jsx)(n.Z,{children:(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(o.A,{className:"h-10 w-10 text-gray-400 bg-gray-100 rounded-full p-2"}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:p.full_name}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 font-mono",children:["RUT: ",p.rut_passport]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Curso: ",(null==(e=p.course)?void 0:e.name)||"No asignado"]})]})]})})}),(0,a.jsx)(n.Z,{children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[(0,a.jsx)(m.A,{className:"h-5 w-5 mr-2"}),"Historial de Retiros"]}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[f.length," retiro",1!==f.length?"s":""," registrado",1!==f.length?"s":""]})]}),N?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Cargando historial..."})]}):f.length>0?(0,a.jsx)("div",{className:"space-y-4",children:f.map(e=>{let t=(e=>{let t=new Date(e);return{date:b(t),time:new Intl.DateTimeFormat("es-CL",{hour:"2-digit",minute:"2-digit",hour12:!1}).format(new Date(t)),relative:(e=>{let t=Math.floor((new Date().getTime()-new Date(e).getTime())/36e5);if(t<1)return"Hace menos de una hora";if(t<24)return"Hace ".concat(t," hora").concat(t>1?"s":"");let s=Math.floor(t/24);if(s<7)return"Hace ".concat(s," d\xeda").concat(s>1?"s":"");let a=Math.floor(s/7);if(a<4)return"Hace ".concat(a," semana").concat(a>1?"s":"");let r=Math.floor(s/30);return"Hace ".concat(r," mes").concat(r>1?"es":"")})(t)}})(e.pickup_timestamp);return(0,a.jsx)("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)(x.A,{className:"h-5 w-5 text-green-600 mr-2"}),(0,a.jsx)("span",{className:"text-sm font-medium text-green-800",children:"Retiro Exitoso"}),(0,a.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:t.relative})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"Retirado por:"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.authorized_person.full_name}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.authorized_person.relationship})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"Registrado por:"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.recorded_by_user})]})]})]}),(0,a.jsxs)("div",{className:"text-right ml-4 flex-shrink-0",children:[(0,a.jsxs)("div",{className:"flex items-center text-gray-500 mb-1",children:[(0,a.jsx)(h.A,{className:"h-4 w-4 mr-1"}),(0,a.jsx)("span",{className:"text-xs font-medium",children:t.time})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 capitalize",children:t.date})]})]})},e.id)})}):(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(m.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,a.jsx)("h4",{className:"mt-2 text-sm font-medium text-gray-900",children:"El alumno no tiene historial de retiros"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"No se han registrado retiros para este estudiante hasta el momento."})]})]})}),f.length>0&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsx)(n.Z,{children:(0,a.jsxs)("div",{className:"p-4 text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:f.length}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Total de Retiros"})]})}),(0,a.jsx)(n.Z,{children:(0,a.jsxs)("div",{className:"p-4 text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:new Set(f.map(e=>e.authorized_person_id)).size}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Personas Distintas"})]})}),(0,a.jsx)(n.Z,{children:(0,a.jsxs)("div",{className:"p-4 text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:f.length>0?b(new Date(f[0].pickup_timestamp)):"N/A"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"\xdaltimo Retiro"})]})})]})]})}):(0,a.jsx)(l.A,{children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(d.A,{className:"mx-auto h-12 w-12 text-yellow-400"}),(0,a.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No se encontr\xf3 informaci\xf3n del estudiante"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"No se pudo encontrar un estudiante asociado a su RUT."})]})})})}},13741:(e,t,s)=>{"use strict";s.d(t,{$:()=>l});var a=s(95155);s(12115);var r=s(52596);let l=e=>{let{variant:t="primary",size:s="md",isLoading:l=!1,className:n,children:i,disabled:c,...d}=e;return(0,a.jsxs)("button",{className:(0,r.$)("inline-flex items-center justify-center font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500",secondary:"bg-gray-200 hover:bg-gray-300 text-gray-900 focus:ring-gray-500",danger:"bg-red-600 hover:bg-red-700 text-white focus:ring-red-500",success:"bg-green-600 hover:bg-green-700 text-white focus:ring-green-500"}[t],{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[s],n),disabled:c||l,...d,children:[l&&(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-current",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),i]})}},14170:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(12115);let r=a.forwardRef(function(e,t){let{title:s,titleId:r,...l}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},l),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))})},17703:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});var a=s(95155);s(12115);var r=s(52596);let l=e=>{let{children:t,className:s,padding:l="md"}=e;return(0,a.jsx)("div",{className:(0,r.$)("bg-white rounded-lg shadow-md border border-gray-200",{none:"",sm:"p-4",md:"p-6",lg:"p-8"}[l],s),children:t})}},26884:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(12115);let r=a.forwardRef(function(e,t){let{title:s,titleId:r,...l}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},l),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z"}))})},35695:(e,t,s)=>{"use strict";var a=s(18999);s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},55596:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(12115);let r=a.forwardRef(function(e,t){let{title:s,titleId:r,...l}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},l),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"}))})},55628:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(12115);let r=a.forwardRef(function(e,t){let{title:s,titleId:r,...l}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},l),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))})},69598:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(12115);let r=a.forwardRef(function(e,t){let{title:s,titleId:r,...l}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},l),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))})},72396:(e,t,s)=>{"use strict";s.d(t,{g:()=>l});var a=s(95155);s(12115);var r=s(66766);let l=e=>{let{size:t="md",showText:s=!0,className:l=""}=e;return(0,a.jsxs)("div",{className:"flex items-center space-x-3 ".concat(l),children:[(0,a.jsx)("div",{className:"relative ".concat({sm:"h-8 w-8",md:"h-12 w-12",lg:"h-16 w-16",xl:"h-24 w-24"}[t]),children:(0,a.jsx)(r.default,{src:"https://colegiosagradafamilia.cl/www/wp-content/uploads/2022/04/cropped-logo-hd-1.png",alt:"Colegio Sagrada Familia Logo",fill:!0,className:"object-contain",priority:!0})}),s&&(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"font-bold text-blue-800 ".concat({sm:"text-lg",md:"text-xl",lg:"text-2xl",xl:"text-3xl"}[t]),children:"Colegio Sagrada Familia"}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Sistema de Retiro"})]})]})}},81013:(e,t,s)=>{"use strict";s.d(t,{A:()=>u});var a=s(95155),r=s(12115),l=s(35695),n=s(40283),i=s(72396),c=s(13741);let d=r.forwardRef(function(e,t){let{title:s,titleId:a,...l}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},l),s?r.createElement("title",{id:a},s):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"}))});var o=s(14170),m=s(55596),x=s(74500),h=s(69598);let u=e=>{let{children:t}=e,{user:s,logout:u}=(0,n.A)(),g=(0,l.useRouter)(),[p,v]=(0,r.useState)(!1),f=()=>{u(),g.push("/")},j=[{name:"Bienvenido/a",href:"/parent",icon:d}];return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("header",{className:"hidden lg:block bg-white shadow-sm border-b border-gray-200",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,a.jsx)(i.g,{className:"h-16 w-auto"}),(0,a.jsx)("nav",{className:"flex space-x-8",children:j.map(e=>(0,a.jsxs)("a",{href:e.href,className:"text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium transition-colors duration-200 flex items-center",children:[(0,a.jsx)(e.icon,{className:"h-4 w-4 mr-2"}),e.name]},e.name))})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(o.A,{className:"h-5 w-5 text-gray-500"}),(0,a.jsx)("span",{className:"text-sm text-gray-700",children:null==s?void 0:s.email}),(0,a.jsx)("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full",children:"Apoderado"})]}),(0,a.jsxs)(c.$,{variant:"secondary",size:"sm",onClick:f,className:"flex items-center",children:[(0,a.jsx)(m.A,{className:"h-4 w-4 mr-1"}),"Cerrar Sesi\xf3n"]})]})]})})}),(0,a.jsxs)("header",{className:"lg:hidden bg-white shadow-sm border-b border-gray-200 sticky top-0 z-50",children:[(0,a.jsx)("div",{className:"px-4 sm:px-6",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("button",{onClick:()=>v(!p),className:"p-2 rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",children:p?(0,a.jsx)(x.A,{className:"h-6 w-6"}):(0,a.jsx)(h.A,{className:"h-6 w-6"})}),(0,a.jsx)(i.g,{className:"h-16 w-auto ml-3"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full",children:"Apoderado"}),(0,a.jsx)(c.$,{variant:"secondary",size:"sm",onClick:f,className:"p-2",children:(0,a.jsx)(m.A,{className:"h-4 w-4"})})]})]})}),p&&(0,a.jsxs)("div",{className:"fixed inset-0 z-40 lg:hidden",children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25",onClick:()=>v(!1)}),(0,a.jsxs)("div",{className:"fixed top-16 left-0 bottom-0 w-64 bg-white shadow-xl overflow-y-auto",children:[(0,a.jsx)("nav",{className:"px-4 py-6 space-y-2",children:j.map(e=>(0,a.jsxs)("a",{href:e.href,onClick:()=>v(!1),className:"flex items-center px-3 py-3 text-gray-700 hover:text-blue-600 hover:bg-blue-50 rounded-lg text-sm font-medium transition-colors duration-200",children:[(0,a.jsx)(e.icon,{className:"h-5 w-5 mr-3 flex-shrink-0"}),e.name]},e.name))}),(0,a.jsx)("div",{className:"border-t border-gray-200 mt-6 pt-6 px-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,a.jsx)(o.A,{className:"h-8 w-8 text-gray-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:null==s?void 0:s.email}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Apoderado"})]})]})})]})]})]}),(0,a.jsx)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:t})]})}},81727:(e,t,s)=>{Promise.resolve().then(s.bind(s,7758))},82771:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(12115);let r=a.forwardRef(function(e,t){let{title:s,titleId:r,...l}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},l),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))})}},e=>{e.O(0,[647,134,643,441,964,358],()=>e(e.s=81727)),_N_E=e.O()}]);