"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[261],{5261:(e,s,t)=>{t.d(s,{TeacherDashboard:()=>p});var a=t(95155),r=t(12115),l=t(64849),n=t(40283),i=t(67110),c=t(55596),d=t(78046);let o=e=>{var s;let{children:t,showSearch:r=!1,onSearch:l,searchValue:o=""}=e,{user:x,logout:m}=(0,n.A)();return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-10",children:(0,a.jsxs)("div",{className:"px-4 sm:px-6 py-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)(i.gu,{size:"xl",showText:!1,className:"flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"h-8 w-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:(0,a.jsx)("span",{className:"text-sm font-medium text-blue-700",children:null==x||null==(s=x.name)?void 0:s.charAt(0)})}),(0,a.jsxs)("div",{className:"hidden sm:block",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700",children:null==x?void 0:x.name}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:(null==x?void 0:x.role)==="inspector"?"Inspector":"Profesor"})]})]}),(0,a.jsx)(i.$n,{variant:"secondary",size:"sm",onClick:m,className:"p-2 flex-shrink-0",children:(0,a.jsx)(c.A,{className:"h-4 w-4"})})]})]}),(0,a.jsx)("h1",{className:"text-lg sm:text-xl font-bold text-gray-900 text-center mb-4",children:"Sistema de Retiro"}),r&&(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(d.A,{className:"h-5 w-5 text-gray-400"})}),(0,a.jsx)("input",{type:"text",placeholder:"Buscar estudiante...",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 text-sm sm:text-base",value:o,onChange:e=>null==l?void 0:l(e.target.value)})]})]})}),(0,a.jsx)("main",{className:"px-4 sm:px-6 py-4 sm:py-6",children:t}),(0,a.jsxs)("div",{className:"fixed bottom-4 left-4 space-y-2 z-20",children:[(0,a.jsx)(i.j_,{}),(0,a.jsx)(i.p2,{})]})]})};var x=t(6865),m=t(55628),u=t(14170);let h=e=>{let{student:s,isOpen:t,onClose:c}=e,{user:d}=(0,n.A)(),{registerPickup:o,getAuthorizedPersonsByStudent:h}=(0,l.E)(),[g,j]=(0,r.useState)(null),[p,f]=(0,r.useState)(!1),[b,N]=(0,r.useState)(!1),y=h(s.id),v=async()=>{if(g&&d){N(!0);try{await o(s.id,g,d.name),setTimeout(()=>{c(),f(!1),j(null)},1e3)}catch(e){console.error("Error registering pickup:",e)}finally{N(!1)}}},w=()=>{f(!1),j(null)},k=y.find(e=>e.id===g);return"Retirado"===s.status?(0,a.jsx)(i.aF,{isOpen:t,onClose:c,title:"Estudiante ya retirado",children:(0,a.jsxs)("div",{className:"text-center py-6",children:[(0,a.jsx)(x.A,{className:"mx-auto h-12 w-12 text-green-500 mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:s.full_name}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"Este estudiante ya ha sido retirado."}),(0,a.jsx)(i.$n,{onClick:c,variant:"secondary",children:"Cerrar"})]})}):p&&k?(0,a.jsx)(i.aF,{isOpen:t,onClose:w,title:"Confirmar retiro",children:(0,a.jsxs)("div",{className:"text-center py-6",children:[(0,a.jsx)(m.A,{className:"mx-auto h-12 w-12 text-yellow-500 mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Confirmar retiro"}),(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg mb-6",children:[(0,a.jsxs)("p",{className:"text-gray-800 mb-2",children:[(0,a.jsx)("strong",{children:"Estudiante:"})," ",s.full_name]}),(0,a.jsxs)("p",{className:"text-gray-800 mb-2",children:[(0,a.jsx)("strong",{children:"Curso:"})," ",s.course.name]}),(0,a.jsxs)("p",{className:"text-gray-800",children:[(0,a.jsx)("strong",{children:"Persona autorizada:"})," ",k.full_name," (",k.relationship,")"]})]}),(0,a.jsxs)("p",{className:"text-gray-600 mb-6",children:["\xbfConfirmas el retiro de ",s.full_name," por ",k.full_name,"?"]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3 justify-center",children:[(0,a.jsx)(i.$n,{onClick:w,variant:"secondary",disabled:b,className:"w-full sm:w-auto",children:"Cancelar"}),(0,a.jsx)(i.$n,{onClick:v,variant:"success",isLoading:b,disabled:b,className:"w-full sm:w-auto",children:b?"Registrando...":"Confirmar retiro"})]})]})}):(0,a.jsx)(i.aF,{isOpen:t,onClose:c,title:"Registrar retiro",size:"lg",children:(0,a.jsxs)("div",{className:"py-4",children:[(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)(u.A,{className:"h-5 w-5 text-blue-600 mr-2"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:s.full_name})]}),(0,a.jsxs)("p",{className:"text-gray-700",children:[(0,a.jsx)("strong",{children:"Curso:"})," ",s.course.name]})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h4",{className:"text-base sm:text-md font-medium text-gray-900 mb-4",children:"Selecciona la persona autorizada que retira al estudiante:"}),y.length>0?(0,a.jsx)("div",{className:"space-y-3",children:y.map(e=>(0,a.jsx)("button",{onClick:()=>{j(e.id),f(!0)},className:"w-full p-4 text-left border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 touch-manipulation active:bg-blue-100",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h5",{className:"font-medium text-gray-900 text-sm sm:text-base truncate",children:e.full_name}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-gray-600 truncate",children:e.relationship})]}),(0,a.jsx)("div",{className:"text-blue-600 flex-shrink-0 ml-3",children:(0,a.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})},e.id))}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(m.A,{className:"mx-auto h-12 w-12 text-yellow-500 mb-4"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4 text-sm sm:text-base",children:"No hay personas autorizadas registradas para este estudiante."}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-gray-500",children:"Contacta al administrador para agregar personas autorizadas."})]})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)(i.$n,{onClick:c,variant:"secondary",className:"w-full sm:w-auto",children:"Cancelar"})})]})})},g=r.forwardRef(function(e,s){let{title:t,titleId:a,...l}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":a},l),t?r.createElement("title",{id:a},t):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"}))}),j=r.forwardRef(function(e,s){let{title:t,titleId:a,...l}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":a},l),t?r.createElement("title",{id:a},t):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}),p=()=>{let{courses:e,studentsWithCourses:s,searchStudents:t,getStudentWithAuthorizedPersons:n}=(0,l.E)(),[c,d]=(0,r.useState)(""),[m,p]=(0,r.useState)(null),[f,b]=(0,r.useState)(null),N=c?t(c):s,y=e.map(e=>({course:e,students:N.filter(s=>s.course_id===e.id)})).filter(e=>e.students.length>0),v=e=>{let s=n(e.id);s&&b(s)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o,{showSearch:!0,onSearch:d,searchValue:c,children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6",children:[(0,a.jsxs)(i.Zp,{className:"p-4 text-center",children:[(0,a.jsx)("div",{className:"flex items-center justify-center mb-2",children:(0,a.jsx)(u.A,{className:"h-6 w-6 text-blue-600"})}),(0,a.jsx)("p",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:N.filter(e=>"Presente"===e.status).length}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Presentes"})]}),(0,a.jsxs)(i.Zp,{className:"p-4 text-center",children:[(0,a.jsx)("div",{className:"flex items-center justify-center mb-2",children:(0,a.jsx)(x.A,{className:"h-6 w-6 text-green-600"})}),(0,a.jsx)("p",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:N.filter(e=>"Retirado"===e.status).length}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Retirados"})]})]}),c?(0,a.jsx)(i.Zp,{children:(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("h3",{className:"font-medium text-gray-900 mb-3",children:["Resultados de b\xfasqueda (",N.length,")"]}),(0,a.jsx)("div",{className:"space-y-3",children:N.map(e=>(0,a.jsxs)("div",{onClick:()=>v(e),className:"\n                        flex items-center justify-between p-4 rounded-lg border cursor-pointer transition-colors touch-manipulation\n                        ".concat("Retirado"===e.status?"bg-gray-50 border-gray-200 opacity-60":"bg-white border-gray-200 hover:bg-blue-50 hover:border-blue-300 active:bg-blue-100","\n                      "),children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h4",{className:"font-medium text-sm sm:text-base truncate ".concat("Retirado"===e.status?"line-through text-gray-500":"text-gray-900"),children:e.full_name}),(0,a.jsx)("p",{className:"text-xs sm:text-sm text-gray-600 truncate",children:e.course.name})]}),(0,a.jsx)("div",{className:"text-right flex-shrink-0 ml-3",children:(0,a.jsx)("span",{className:"\n                          inline-flex items-center px-2 py-1 rounded-full text-xs font-medium\n                          ".concat("Presente"===e.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800","\n                        "),children:e.status})})]},e.id))})]})}):(0,a.jsx)("div",{className:"space-y-4",children:y.map(e=>{let{course:s,students:t}=e,r=m===s.id,l=t.filter(e=>"Presente"===e.status).length,n=t.length;return(0,a.jsxs)(i.Zp,{children:[(0,a.jsx)("div",{className:"p-4 cursor-pointer",onClick:()=>(e=>{p(m===e?null:e)})(s.id),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:s.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[l," de ",n," presentes"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"text-right",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[l," presentes"]}),n-l>0&&(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[n-l," retirados"]})]})}),r?(0,a.jsx)(g,{className:"h-5 w-5 text-gray-400"}):(0,a.jsx)(j,{className:"h-5 w-5 text-gray-400"})]})]})}),r&&(0,a.jsx)("div",{className:"border-t border-gray-200",children:(0,a.jsx)("div",{className:"p-4 space-y-3",children:t.map(e=>(0,a.jsxs)("div",{onClick:()=>v(e),className:"\n                                flex items-center justify-between p-4 rounded-lg border cursor-pointer transition-colors touch-manipulation\n                                ".concat("Retirado"===e.status?"bg-gray-50 border-gray-200 opacity-60":"bg-white border-gray-200 hover:bg-blue-50 hover:border-blue-300 active:bg-blue-100","\n                              "),children:[(0,a.jsx)("div",{className:"flex-1 min-w-0",children:(0,a.jsx)("h4",{className:"font-medium text-sm sm:text-base truncate ".concat("Retirado"===e.status?"line-through text-gray-500":"text-gray-900"),children:e.full_name})}),(0,a.jsx)("div",{className:"text-right flex-shrink-0 ml-3",children:(0,a.jsx)("span",{className:"\n                                  inline-flex items-center px-2 py-1 rounded-full text-xs font-medium\n                                  ".concat("Presente"===e.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800","\n                                "),children:e.status})})]},e.id))})})]},s.id)})}),0===N.length&&(0,a.jsx)(i.Zp,{className:"p-8 text-center",children:(0,a.jsx)("p",{className:"text-gray-500",children:c?"No se encontraron estudiantes":"No hay estudiantes disponibles"})})]})}),f&&(0,a.jsx)(h,{student:f,isOpen:!!f,onClose:()=>b(null)})]})}},14170:(e,s,t)=>{t.d(s,{A:()=>r});var a=t(12115);let r=a.forwardRef(function(e,s){let{title:t,titleId:r,...l}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":r},l),t?a.createElement("title",{id:r},t):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))})},55596:(e,s,t)=>{t.d(s,{A:()=>r});var a=t(12115);let r=a.forwardRef(function(e,s){let{title:t,titleId:r,...l}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":r},l),t?a.createElement("title",{id:r},t):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"}))})},78046:(e,s,t)=>{t.d(s,{A:()=>r});var a=t(12115);let r=a.forwardRef(function(e,s){let{title:t,titleId:r,...l}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:s,"aria-labelledby":r},l),t?a.createElement("title",{id:r},t):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))})}}]);